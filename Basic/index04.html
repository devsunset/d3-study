<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>D3.js & Data</title>
		<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
		<style>
			svg { width: 320px; height: 240px; border: 1px solid black; }
			.bar { fill : orange; }
		</style>
	</head>
	<body>
		<h1>Data</h1>
		<svg id="myGraph1"></svg>
        <svg id="myGraph2"></svg>
        <svg id="myGraph3"></svg>
        <svg id="myGraph4"></svg>
        <svg id="myGraph5"></svg>
        <svg id="myGraph6"></svg>
        <svg id="myGraph7"></svg>
        <svg id="myGraph8"></svg>
        <svg id="myGraph9"></svg>
        <svg id="myGraph10"></svg>
        <svg id="myGraph11"></svg>
		<script>
            // 데이터셋이 코드 안에 배열로 준비되었을 때
            var dataSet = [ 50, 10, 120, 200, 90 ];
            // 그래프 그리기
            d3.select("#myGraph1")
                .selectAll("rect")	// rect 요소를 지정
                .data(dataSet)	// 데이터를 요소에 연결
                .enter()	// 데이터 개수만큼 반복
                .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                .attr("class", "bar")	// CSS 클래스를 지정
                .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                    return d;	// 데이터 값을 그대로 넓이로 반환
                })
                .attr("height", 20)	// 높이를 지정
                .attr("x", 0)	// X 좌표를 0으로 함
                .attr("y", function(d, i){	// Y 좌표를 지정함
                    return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                })

            // 데이터셋이 TSV 파일일 때
            d3.tsv("data.tsv", function(error, data){
                var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                for(var i=0; i<data.length; i++){	// 데이터 줄 수만큼 반복
                    dataSet.push(data[i].item1);	// item1의 레이블 데이터만 추출
                }
                // 그래프 그리기
                d3.select("#myGraph2")
                    .selectAll("rect")	// rect 요소 지정
                    .data(dataSet)	// 데이터를 요소에 연결
                    .enter()	// 데이터 개수만큼 반복
                    .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                    .attr("class", "bar")	// CSS 클래스를 지정
                    .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                        return d;	// 데이터 값을 그대로 넓이로 반환
                    })
                    .attr("height", 20)	// 높이를 지정
                    .attr("x", 0)	// X 좌표를 0으로 함
                    .attr("y", function(d, i){	// Y 좌표를 지정함
                        return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                    })
            })


            // 데이터셋이 CSV 파일일 때
            d3.csv("data_bar1.csv", function(error, data){
                var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                for(var i=0; i<data.length; i++){	// 데이터 줄 수만큼 반복
                    dataSet.push(data[i].item1);	// item1의 레이블 데이터만 추출
                }
                // 그래프 그리기
                d3.select("#myGraph3")
                .selectAll("rect")	// rect 요소 지정
                .data(dataSet)	// 데이터를 요소에 연결
                .enter()	// 데이터 개수만큼 반복
                .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                .attr("class", "bar")	// CSS 클래스를 지정
                .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                        return d;	// 데이터 값을 그대로 넓이로 반환
                })
                .attr("height", 20)	// 높이를 지정
                .attr("x", 0)	// X 좌표를 0으로 함
                .attr("y", function(d, i){	// Y 좌표를 지정함
                        return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                })
            })

            // 데이터셋이 CSV 파일일 때(헤더가 한글일 때)
            d3.csv("data_kor.csv", function(error, data){
                    var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                    for(var i=0; i<data.length; i++){	// 데이터 줄 수만큼 반복
                        dataSet.push(data[i]["상품A"]);	// 상품A의 레이블 데이터만 추출
                    }
                    // 그래프 그리기
                    d3.select("#myGraph4")
                    .selectAll("rect")	// rect 요소 지정
                    .data(dataSet)	// 데이터를 요소에 연결
                    .enter()	// 데이터 개수만큼 반복
                    .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                    .attr("class", "bar")	// CSS 클래스를 지정
                    .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                            return d;	// 데이터 값을 그대로 넓이로 반환
                        })
                    .attr("height", 20)	// 높이를 지정
                    .attr("x", 0)	// X 좌표를 0으로 함
                    .attr("y", function(d, i){	// Y 좌표를 지정함
                            return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                        })
                })

                // 데이터셋이 CSV 파일일 때
                d3.csv("data_kor.csv")
                    .row(function(d){
                        return {
                            item1 : d["상품A"],
                            item2 : d["상품B"],
                            item3 : d["상품C"],
                        }
                    })
                    .get(function(error, data){
                        var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                        for(var i=0; i<data.length; i++){	// 데이터 줄 수만큼 반복
                            dataSet.push(data[i].item1);	// 상품A＝item1의 레이블 데이터만 추출
                        }
                    // 그래프 그리기
                    d3.select("#myGraph5")
                    .selectAll("rect")	// rect 요소 지정
                    .data(dataSet)	// 데이터를 요소에 연결
                    .enter()	// 데이터 개수만큼 반복
                    .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                    .attr("class", "bar")	// CSS 클래스를 지정
                    .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                        return d;	// 데이터 값을 그대로 넓이로 반환
                    })
                    .attr("height", 20)	// 높이를 지정
                    .attr("x", 0)	// X 좌표를 0으로 함
                    .attr("y", function(d, i){	// Y 좌표를 지정함
                        return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                    })
                })

                // 데이터셋이 CSV 파일일 때
                d3.csv("data_kor.csv")
                    .row(function(d){
                        return {
                            item1 : d["상품A"] / 2	// 데이터 가공
                        }
                    })
                    .get(function(error, data){
                        var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                        for(var i=0; i<data.length; i++){	// 데이터 줄 수만큼 반복
                            dataSet.push(data[i].item1);	// 상품A＝item1의 레이블 데이터만 추출
                        }
                    // 그래프 그리기
                    d3.select("#myGraph6")
                        .selectAll("rect")	// rect 요소 지정
                        .data(dataSet)	// 데이터를 요소에 연결
                        .enter()	// 데이터 개수만큼 반복
                        .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                        .attr("class", "bar")	// CSS 클래스를 지정
                        .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                            return d;	// 데이터 값을 그대로 넓이로 반환
                        })
                        .attr("height", 20)	// 높이를 지정
                        .attr("x", 0)	// X 좌표를 0으로 함
                        .attr("y", function(d, i){	// Y 좌표를 지정함
                            return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                        })
                })

                // 데이터셋이 JSON 파일일 때
                d3.json("data.json", function(error, data){
                    var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                    for(var i=0; i<data.length; i++){	// 데이터 줄 수만큼 반복
                        dataSet.push(data[i].sales[0]);	// sales의 최초 데이터만 추출
                    }
                    // 그래프 그리기
                    d3.select("#myGraph7")
                    .selectAll("rect")	// rect 요소 지정
                    .data(dataSet)	// 데이터를 요소에 연결
                    .enter()	// 데이터 개수만큼 반복
                    .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                    .attr("class", "bar")	// CSS 클래스를 지정
                    .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                            return d;	// 데이터 값을 그대로 넓이로 반환
                        })
                    .attr("height", 20)	// 높이를 지정
                    .attr("x", 0)	// X 좌표를 0으로 함
                    .attr("y", function(d, i){	// Y 좌표를 지정함
                            return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                        })
                })

                // 데이터셋이 HTML 파일일 때
                d3.html("data.html", function(error, docFragment){
                    var tr = docFragment.querySelectorAll("table tr");	// table 요소에서 tr 요소를 추출
                    var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                    for(var i=1; i<tr.length; i++){	// tr 요소의 줄 수-1만큼 반복(1번째 행 헤더는 무시)
                        var d = tr[i].querySelectorAll("td")[0].firstChild.nodeValue;	// 데이터 읽어들이기
                        dataSet.push(d);	// 상품A의 데이터만 추출
                    }
                    // 그래프 그리기
                    d3.select("#myGraph8")
                    .selectAll("rect")	// rect 요소 지정
                    .data(dataSet)	// 데이터를 요소에 연결
                    .enter()	// 데이터 개수만큼 반복
                    .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                    .attr("class", "bar")	// CSS 클래스를 지정
                    .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                            return d;	// 데이터 값을 그대로 넓이로 반환
                    })
                    .attr("height", 20)	// 높이를 지정
                    .attr("x", 0)	// X 좌표를 0으로 함
                    .attr("y", function(d, i){	// Y 좌표를 지정함
                            return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                    })
                })

             // 데이터셋이 XML 파일일 때
            d3.xml("data.xml", function(error, xmlRoot){
                var xmlData = xmlRoot.querySelectorAll("data");	// data 요소를 추출
                var salesRoot = xmlData[0];	// 상품A의 데이터만 추출
                var salesData = salesRoot.querySelectorAll("sales");	// sales 요소를 추출
                var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                for(var i=0; i<salesData.length; i++){	// sales 요소 개수만큼 반복
                    var d = salesData[i].firstChild.nodeValue;	// 데이터 읽어들이기
                    dataSet.push(d);
                }
                // 그래프 그리기
                d3.select("#myGraph9")
                .selectAll("rect")	// rect 요소 지정
                .data(dataSet)	// 데이터를 요소에 연결
                .enter()	// 데이터 개수만큼 반복
                .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                .attr("class", "bar")	// CSS 클래스를 지정
                .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                        return d;	// 데이터 값을 그대로 넓이로 반환
                })
                .attr("height", 20)	// 높이를 지정
                .attr("x", 0)	// X 좌표를 0으로 함
                .attr("y", function(d, i){	// Y 좌표를 지정함
                        return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                })
            })

            // 데이터셋이 플레인 텍스트 파일일 때
            d3.text("data.txt", function(error, plainText){
                var data = plainText.split("\x0a");	// \0x0a는 줄바꿈 코드
                var dataSet = [ ];	// 데이터를 저장할 배열을 준비
                var sales = data[0].split("/");	// 처음 1줄을 / 구분자로 나누어 데이터를 분할
                for(var i=1; i<sales.length; i++){
                    dataSet.push(sales[i]);	// sales 데이터 추출
                }
                // 그래프 그리기
                d3.select("#myGraph10")
                .selectAll("rect")	// rect 요소 지정
                .data(dataSet)	// 데이터를 요소에 연결
                .enter()	// 데이터 개수만큼 반복
                .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                .attr("class", "bar")	// CSS 클래스를 지정
                .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                    return d;	// 데이터 값을 그대로 넓이로 반환
                })
                .attr("height", 20)	// 높이를 지정
                .attr("x", 0)	// X 좌표를 0으로 함
                .attr("y", function(d, i){	// Y 좌표를 지정함
                    return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                })
            })

            // 데이터셋이 특정 문자로 구분된 파일일 때
            d3.text("data_dsv.txt", function(error, plainText){
                var dataSet = d3.dsv("_", "text/plain").parse(plainText);
                // 그래프 그리기
                d3.select("#myGraph11")
                .selectAll("rect")	// rect 요소 지정
                .data(dataSet)	// 데이터를 요소에 연결
                .enter()	// 데이터 개수만큼 반복
                .append("rect")	// 데이터 개수만큼 rect 요소가 추가됨
                .attr("class", "bar")	// CSS 클래스를 지정
                .attr("width", function(d,i){	// 넓이를 지정. 두 번째의 파라미터에 함수를 지정
                        return d["상품B"];	// 상품B의 값을 넓이로 반환
                })
                .attr("height", 20)	// 높이를 지정
                .attr("x", 0)	// X 좌표를 0으로 함
                .attr("y", function(d, i){	// Y 좌표를 지정함
                        return i * 25	// 표시 순서에 25를 곱해 위치를 계산
                })
            })
        </script>
	</body>
</html>
